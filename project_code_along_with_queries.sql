Drop table GRAM_PANCHAYAT cascade constraint;
Drop table VILLAGES cascade constraint;
Drop table WARD cascade constraint;
Drop table MACHINES cascade constraint;
Drop table MEMBERS cascade constraint;
Drop table FARMER cascade constraint;
Drop table BILL cascade constraint;
Drop table RENT cascade constraint;


CREATE TABLE GRAM_PANCHAYAT
(
TOT_WARDS NUMBER(3),
TALUKA_NAME VARCHAR2(30),
PANCHAYAT_ID VARCHAR2(30) PRIMARY KEY,
TOT_VILLAGES NUMBER(3)
);


CREATE TABLE VILLAGES
(
PANCHAYAT_ID VARCHAR2(30),
NO_WARDS NUMBER(7),
VILLAGE_NAME VARCHAR2(20) NOT NULL,
WARD_NO NUMBER(8),
AADH_NO NUMBER(7),
CONSTRAINT PK_VILLAGES PRIMARY KEY(PANCHAYAT_ID,VILLAGE_NAME,WARD_NO,AADH_NO),
FOREIGN KEY(PANCHAYAT_ID) REFERENCES GRAM_PANCHAYAT (PANCHAYAT_ID),
FOREIGN KEY(WARD_NO) REFERENCES WARD (WARD_NO),
FOREIGN KEY(AADH_NO) REFERENCES FARMER (AADH_NO)
);

CREATE TABLE WARD
(
WARD_NO NUMBER(7) PRIMARY KEY,
VILLAGE_NAME VARCHAR2(20) NOT NULL,
WARD_NAME VARCHAR2(30) UNIQUE
);


CREATE TABLE FARMER
(
AADH_NO NUMBER(7) PRIMARY KEY,
GENDER VARCHAR2(20) NOT NULL,
NAME1 VARCHAR2(30) UNIQUE
);


CREATE TABLE MEMBERS
(
MEM_ID NUMBER(7) PRIMARY KEY,
WARD_NO NUMBER(7),
MEM_NAME VARCHAR2(30) UNIQUE,
FOREIGN KEY(WARD_NO) REFERENCES WARD (WARD_NO)
);


CREATE TABLE MACHINES
(
SUPR_NAME VARCHAR2(30),
WARD_NO NUMBER(7),
PRICE NUMBER(7),
MACH_ID NUMBER(7) PRIMARY KEY,
MEM_ID NUMBER(7),
MACH_NAME VARCHAR2(30),
FOREIGN KEY(MEM_ID) REFERENCES MEMBERS (MEM_ID),
FOREIGN KEY(WARD_NO) REFERENCES WARD (WARD_NO)
);


CREATE TABLE RENT
(
MACH_ID NUMBER(7),
AADH_NO NUMBER(7),
TIME1 interval day to second,
CONSTRAINT PK_RENT PRIMARY KEY(MACH_ID,AADH_NO),
FOREIGN KEY(MACH_ID) REFERENCES MACHINES (MACH_ID),
FOREIGN KEY(AADH_NO) REFERENCES FARMER (AADH_NO)
);


CREATE TABLE BILL
(
AADH_NO NUMBER(7),
PAYMENT_METHOD VARCHAR2(20) NOT NULL,
DATE1 NUMBER(7),
BILL_ID NUMBER(20) PRIMARY KEY,
AMOUNT NUMBER(7),
FOREIGN KEY(AADH_NO) REFERENCES FARMER (AADH_NO)
);


INSERT INTO GRAM_PANCHAYAT VALUES('5','CHITTAPUR','1234','2');
INSERT INTO GRAM_PANCHAYAT VALUES('6','CHITTAPUR','1235','3');
INSERT INTO GRAM_PANCHAYAT VALUES('7','CHITTAPUR','1236','3');
INSERT INTO GRAM_PANCHAYAT VALUES('4','CHITTAPUR','1237','2');
INSERT INTO GRAM_PANCHAYAT VALUES('5','KALGI','1238','4');
INSERT INTO GRAM_PANCHAYAT VALUES('5','KALGI','1239','2');
INSERT INTO GRAM_PANCHAYAT VALUES('6','CHITAGUPPA','1240','3');
INSERT INTO GRAM_PANCHAYAT VALUES('8','SURPUR','1241','5');
INSERT INTO GRAM_PANCHAYAT VALUES('5','SHAHPUR','1242','2');
INSERT INTO GRAM_PANCHAYAT VALUES('6','SURPUR','1243','5');
INSERT INTO GRAM_PANCHAYAT VALUES('8','SURPUR','1244','4');
INSERT INTO GRAM_PANCHAYAT VALUES('7','KALGI','1245','6');
INSERT INTO GRAM_PANCHAYAT VALUES('2','CHITAGUPPA','1246','2');
INSERT INTO GRAM_PANCHAYAT VALUES('4','SHAHPUR','1247','3');
INSERT INTO GRAM_PANCHAYAT VALUES('5','CHITTAPUR','1248','4');
INSERT INTO GRAM_PANCHAYAT VALUES('8','KALGI','1249','7');
INSERT INTO GRAM_PANCHAYAT VALUES('7','HUBLI','1250','4');
INSERT INTO GRAM_PANCHAYAT VALUES('5','HUBLI','1251','3');
INSERT INTO GRAM_PANCHAYAT VALUES('6','SURPUR','1252','2');
INSERT INTO GRAM_PANCHAYAT VALUES('5','SHAHPUR','1253','3');

INSERT INTO WARD VALUES('123','CHITTAPUR','GANESHNAGAR');
INSERT INTO WARD VALUES('124','CHITTAPUR','VENKATESHNAGAR');
INSERT INTO WARD VALUES('125','KODADUR','NADAGATTI');
INSERT INTO WARD VALUES('126','BHANKALGI','BUS_STAND');
INSERT INTO WARD VALUES('127','CHITTAPUR','EK_KAMAN');
INSERT INTO WARD VALUES('128','CHITTAPUR','HOLI_KATTA');
INSERT INTO WARD VALUES('129','BHAGODI','AUTO_STAND');
INSERT INTO WARD VALUES('130','ALLUR','THANDA');
INSERT INTO WARD VALUES('131','MOGLA','MOGLA');
INSERT INTO WARD VALUES('132','AURAD','BHAVANI_NAGAR');
INSERT INTO WARD VALUES('133','HUMNABAD','NAGAVI');
INSERT INTO WARD VALUES('134','CHITTAPUR','BRAHMIN_GALLI');
INSERT INTO WARD VALUES('135','DANDOTI','HANUMAN_TEMPLE');
INSERT INTO WARD VALUES('136','EVANI','HOSUR_CROSS');
INSERT INTO WARD VALUES('137','HERUR','BHARPET');
INSERT INTO WARD VALUES('138','HOSSUR','VITTHAL_MANDIR');
INSERT INTO WARD VALUES('139','ITGA','KHARKHANI');
INSERT INTO WARD VALUES('140','KALGURTHI','RAILWAY_STATION');
INSERT INTO WARD VALUES('141','KARDAL','MARKET');
INSERT INTO WARD VALUES('142','KORWAR','HOSPITAL');


INSERT INTO FARMER VALUES('100','MALE','SHASHANK');
INSERT INTO FARMER VALUES('101','MALE','OMKAR');
INSERT INTO FARMER VALUES('102','MALE','SAMPREET');
INSERT INTO FARMER VALUES('103','MALE','DARSHAN');
INSERT INTO FARMER VALUES('104','MALE','SANJEEV');
INSERT INTO FARMER VALUES('105','MALE','RAJEEV');
INSERT INTO FARMER VALUES('106','MALE','RAVI');
INSERT INTO FARMER VALUES('107','MALE','RAMESH');
INSERT INTO FARMER VALUES('108','FEMALE','LAXMI');
INSERT INTO FARMER VALUES('109','MALE','KRISHNA');
INSERT INTO FARMER VALUES('110','FEMALE','SHREEDEVI');
INSERT INTO FARMER VALUES('111','FEMALE','SOUMYA');
INSERT INTO FARMER VALUES('112','MALE','PANDITRAO');
INSERT INTO FARMER VALUES('113','MALE','SIDDAPPA');
INSERT INTO FARMER VALUES('114','FEMALE','JAGADEVI');
INSERT INTO FARMER VALUES('115','MALE','GUNDERAO');
INSERT INTO FARMER VALUES('116','MALE','SHARAD');
INSERT INTO FARMER VALUES('117','FEMALE','PARVATHI');
INSERT INTO FARMER VALUES('118','MALE','RUPESH');
INSERT INTO FARMER VALUES('119','MALE','MADYAPPA');


INSERT INTO MEMBERS VALUES('200','123','MALLAPPA');
INSERT INTO MEMBERS VALUES('201','124','MAHADEVI');
INSERT INTO MEMBERS VALUES('202','125','BASAPPA');
INSERT INTO MEMBERS VALUES('203','126','PARVATI');
INSERT INTO MEMBERS VALUES('204','127','SUNITA');
INSERT INTO MEMBERS VALUES('205','128','SIVAMMA');
INSERT INTO MEMBERS VALUES('206','129','LALITA');
INSERT INTO MEMBERS VALUES('207','130','ANITA');
INSERT INTO MEMBERS VALUES('208','131','SAIYAD');
INSERT INTO MEMBERS VALUES('209','132','BHARATI');
INSERT INTO MEMBERS VALUES('210','133','NAGAPPA');
INSERT INTO MEMBERS VALUES('211','134','SARASVATI');
INSERT INTO MEMBERS VALUES('212','135','MALLIKARJUN');
INSERT INTO MEMBERS VALUES('213','136','ANAND');
INSERT INTO MEMBERS VALUES('214','137','SARANAPPA');
INSERT INTO MEMBERS VALUES('215','138','MAHESH');
INSERT INTO MEMBERS VALUES('216','139','GANGAVVA');
INSERT INTO MEMBERS VALUES('217','140','YALLAVVA');
INSERT INTO MEMBERS VALUES('218','141','KAMALAMMA');
INSERT INTO MEMBERS VALUES('219','142','HANMANTH');

INSERT INTO BILL VALUES('100','UPI','12','500','200');
INSERT INTO BILL VALUES('101','CASH','13','501','200');
INSERT INTO BILL VALUES('102','CASH','13','502','300');
INSERT INTO BILL VALUES('103','UPI','15','503','250');
INSERT INTO BILL VALUES('104','CASH','16','504','300');
INSERT INTO BILL VALUES('105','UPI','16','505','350');
INSERT INTO BILL VALUES('106','UPI','17','506','400');
INSERT INTO BILL VALUES('107','UPI','16','507','350');
INSERT INTO BILL VALUES('108','UPI','14','508','400');
INSERT INTO BILL VALUES('109','CASH','16','509','360');
INSERT INTO BILL VALUES('110','CASH','17','510','450');
INSERT INTO BILL VALUES('111','UPI','16','511','400');
INSERT INTO BILL VALUES('112','CASH','18','512','450');
INSERT INTO BILL VALUES('113','CASH','16','513','500');
INSERT INTO BILL VALUES('114','UPI','13','514','300');
INSERT INTO BILL VALUES('115','UPI','14','515','350');
INSERT INTO BILL VALUES('116','UPI','14','516','300');
INSERT INTO BILL VALUES('117','CASH','15','517','350');
INSERT INTO BILL VALUES('118','CASH','13','518','450');
INSERT INTO BILL VALUES('119','UPI','15','519','500');
INSERT INTO BILL VALUES('119','UPI','15','520','600');

INSERT INTO VILLAGES VALUES('1234','16','BAIRIDEVARAKOPPA','123','100');
INSERT INTO VILLAGES VALUES('1235','14','SANGLI','124','101');
INSERT INTO VILLAGES VALUES('1236','17','INGALAHALLI','125','102');
INSERT INTO VILLAGES VALUES('1237','10','HOSAHALLI','126','103');
INSERT INTO VILLAGES VALUES('1238','11','SIDEDAHALLI','127','104');
INSERT INTO VILLAGES VALUES('1239','16','GOLLARAHALLI','128','105');
INSERT INTO VILLAGES VALUES('1240','22','RAMOHALLI','129','106');
INSERT INTO VILLAGES VALUES('1241','10','HOODI','130','107');
INSERT INTO VILLAGES VALUES('1242','16','KODATHI','131','108');
INSERT INTO VILLAGES VALUES('1243','14','HOSKOTE','132','109');
INSERT INTO VILLAGES VALUES('1244','11','KADUGODI','133','110');
INSERT INTO VILLAGES VALUES('1245','15','VAJRAHALLI','134','111');
INSERT INTO VILLAGES VALUES('1246','14','BANSWADI','135','112');
INSERT INTO VILLAGES VALUES('1247','25','VARTHUR','136','113');
INSERT INTO VILLAGES VALUES('1248','16','MULLUR','137','114');
INSERT INTO VILLAGES VALUES('1249','16','KOTHNUR','138','115');
INSERT INTO VILLAGES VALUES('1250','17','BELLANDUR','139','116');
INSERT INTO VILLAGES VALUES('1251','11','HUSKURU','140','117');
INSERT INTO VILLAGES VALUES('1252','16','KORALUR','141','118');
INSERT INTO VILLAGES VALUES('1253','19','MRATHAHALLI','142','119');

INSERT INTO MACHINES VALUES('SAMPREET','123','200','300','200','ROTAVATOR');
INSERT INTO MACHINES VALUES('OMKAR','124','500','301','201','COMBINE HARVESTOR');
INSERT INTO MACHINES VALUES('SHASHANK','125','600','303','202','TRACTOR');
INSERT INTO MACHINES VALUES('DARSHAN','126','200','304','203','TRAILER');
INSERT INTO MACHINES VALUES('SAMPREET','127','100','305','204','PLOUGH');
INSERT INTO MACHINES VALUES('SAMPREET','128','200','306','205','CULTIVATOR');
INSERT INTO MACHINES VALUES('SHASHANK','129','300','307','206','DISK HARROW');
INSERT INTO MACHINES VALUES('OMKAR','130','200','308','207','LEVELER');
INSERT INTO MACHINES VALUES('DARSHAN','131','500','309','208','POWER HARROW');
INSERT INTO MACHINES VALUES('OMKAR','131','100','310','209','THRESHER');
INSERT INTO MACHINES VALUES('SAMPREET','123','200','311','200','TYNE RIDGER');
INSERT INTO MACHINES VALUES('SHASHANK','132','100','312','210','ROTAVATOR');
INSERT INTO MACHINES VALUES('DARSHAN','133','200','313','211','ROTAVATOR');
INSERT INTO MACHINES VALUES('SAMPREET','123','200','314','212','TRACTOR');
INSERT INTO MACHINES VALUES('DARSHAN','134','50','315','200','PLOUGH');
INSERT INTO MACHINES VALUES('DARSHAN','125','300','316','213','LEVELER');
INSERT INTO MACHINES VALUES('OMKAR','126','500','317','211','THRESHER');
INSERT INTO MACHINES VALUES('SAMPREET','123','200','318','212','DISK HARROW');
INSERT INTO MACHINES VALUES('DARSHAN','128','200','319','213','LEVELER');

INSERT INTO RENT VALUES('301','100','0 11:50:24');
INSERT INTO RENT VALUES('304','101','0 12:50:24');
INSERT INTO RENT VALUES('303','102','0 13:50:24');
INSERT INTO RENT VALUES('304','103','0 11:50:24');
INSERT INTO RENT VALUES('305','104','0 08:07:36');
INSERT INTO RENT VALUES('306','104','0 11:50:25');
INSERT INTO RENT VALUES('307','107','0 11:50:52');
INSERT INTO RENT VALUES('308','108','0 06:50:47');
INSERT INTO RENT VALUES('309','100','0 11:50:24');
INSERT INTO RENT VALUES('310','109','0 11:50:24');
INSERT INTO RENT VALUES('311','110','0 14:23:45');
INSERT INTO RENT VALUES('312','107','0 07:23:45');
INSERT INTO RENT VALUES('313','108','0 07:23:54');
INSERT INTO RENT VALUES('314','114','0 18:45:24');
INSERT INTO RENT VALUES('315','116','0 22:14:24');
INSERT INTO RENT VALUES('316','100','0 11:50:24');
INSERT INTO RENT VALUES('317','103','0 12:50:24');
INSERT INTO RENT VALUES('318','104','0 11:13:24');
INSERT INTO RENT VALUES('319','107','0 11:17:24');

SELECT * FROM RENT

SELECT * FROM VILLAGES

1.'To find the average price of all machines'

SELECT AVG(PRICE) FROM MACHINES

2.'To find the minimum price of all machines'

SELECT MIN(PRICE)
FROM MACHINES

3.'To find the total number of farmers'

SELECT COUNT(*)
FROM FARMER

4.'To find the total number of gram panchayats'

SELECT COUNT(*)
FROM GRAM_PANCHAYAT

5.'To find the maximum bill paid for a specific bill id'

SELECT MAX(AMOUNT)
FROM BILL
WHERE BILL_ID=503

6.'Retrieve the name and aadhar number of the farmer whose bill id=507 and whose machine id is 307.'

SELECT F.NAME1,F.AADH_NO
FROM FARMER F
JOIN BILL B ON F.AADH_NO=B.AADH_NO
JOIN RENT R ON R.AADH_NO=F.AADH_NO
WHERE B.BILL_ID=507 AND R.MACH_ID=307

7.'To find the total number of machines supervised by SAMPREET'

SELECT COUNT(*) 
FROM MACHINES
WHERE SUPR_NAME='SAMPREET'

8.'Retrieve the names of all members whose ward name strts with K.'

SELECT M.MEM_NAME
FROM  MEMBERS M 
JOIN WARD W ON W.WARD_NO=M.WARD_NO
WHERE W.WARD_NAME LIKE 'K%'

9.'Retrieve the names of all members who have supervised the machine whose price per day is greater than 200 and the farmers have paid the bill of those machines.'

SELECT UNIQUE(MEM_NAME)
FROM MEMBERS M
JOIN MACHINES MA ON M.MEM_ID=MA.MEM_ID
JOIN RENT R ON R.MACH_ID=MA.MACH_ID
JOIN FARMER F ON F.AADH_NO=R.AADH_NO
JOIN BILL B ON B.AADH_NO=F.AADH_NO
WHERE PRICE>200

10.'Retrieve the taluka name and panchayat id of the gram panchayat whose number of wards of villages is greater than 20.'

SELECT G.TALUKA_NAME,G.PANCHAYAT_ID
FROM GRAM_PANCHAYAT G
JOIN VILLAGES V ON V.PANCHAYAT_ID=G.PANCHAYAT_ID
WHERE NO_WARDS>20

11.'Retrieve the machine id of the machine which has been rented atleast onceand aso display the average bill amount for that corresponding machine id.'

SELECT M.MACH_ID,AVG(B.AMOUNT)
FROM MACHINES M
JOIN RENT R ON R.MACH_ID=M.MACH_ID
JOIN FARMER F ON F.AADH_NO=R.AADH_NO
JOIN BILL B ON B.AADH_NO=F.AADH_NO
GROUP BY M.MACH_ID
HAVING COUNT(R.MACH_ID) > 0;

12.'Retrieve the aadhar number of each of the farmers and the average amounteach farmer has paid till now for renting the machines' 

SELECT B.AADH_NO,AVG(B.AMOUNT)
FROM FARMER F
JOIN BILL B ON B.AADH_NO=F.AADH_NO
GROUP BY(B.AADH_NO)

13.'Retrieve the machine id and name of the machine whose bill amount is minimum among the lot.'

SELECT M.MACH_ID,M.MACH_NAME
FROM MACHINES M
JOIN RENT R ON R.MACH_ID=M.MACH_ID
JOIN FARMER F ON F.AADH_NO=R.AADH_NO
JOIN BILL B ON B.AADH_NO=F.AADH_NO
AND B.AMOUNT=(SELECT MIN(B1.AMOUNT) FROM BILL B1)

14.'Display the number of machines rent by each farmer'

SELECT AADH_NO,COUNT(AADH_NO)
FROM RENT
GROUP BY(AADH_NO)

15.'Retrieve the name of the wards which belong to the villages having the most number of wards.'

SELECT W.WARD_NAME
FROM WARD W
JOIN VILLAGES V ON V.WARD_NO=W.WARD_NO
AND V.NO_WARDS=(SELECT MAX(NO_WARDS) FROM VILLAGES)

16.'Display the machine id and name of the machines whose price per day is the second highest among the lot.'

SELECT MACH_ID,MACH_NAME 
FROM MACHINES M
WHERE 1=(SELECT COUNT(PRICE) FROM MACHINES M2 WHERE M.PRICE<M2.PRICE) 

17.'Display the machine id and name of the machine whose bill amount is greater than the average price per day of the machines which are supervised by memebrs with member id 211'.
                 
SELECT M.MACH_ID,M.MACH_NAME
FROM MACHINES M
JOIN RENT R ON R.MACH_ID=M.MACH_ID
JOIN FARMER F ON F.AADH_NO=R.AADH_NO
JOIN BILL B ON B.AADH_NO=F.AADH_NO
WHERE B.AMOUNT>(SELECT AVG(PRICE) 
                FROM MACHINES M1
                WHERE M1.MEM_ID=211)
                
18.'Write a query to display the details of all the farmers who have rented a machine and the name of the machine they have rented.'                

SELECT FARMER.*, MACHINES.MACH_NAME 
FROM FARMER 
JOIN RENT 
ON FARMER.AADH_NO = RENT.AADH_NO 
JOIN MACHINES 
ON RENT.MACH_ID = MACHINES.MACH_ID;

19.'Write a query to display the total rent paid by each farmer in descending order of the amount.'

SELECT FARMER.NAME1, SUM(BILL.AMOUNT) AS TOTAL_RENT 
FROM FARMER 
JOIN BILL 
ON FARMER.AADH_NO = BILL.AADH_NO 
GROUP BY FARMER.NAME1 
ORDER BY TOTAL_RENT DESC;

20.'Write a query to display the total number of machines rented from each ward in descending order of the number of machines.'

SELECT WARD.WARD_NAME, COUNT(RENT.MACH_ID) AS TOTAL_MACHINES 
FROM WARD 
JOIN MACHINES 
ON WARD.WARD_NO = MACHINES.WARD_NO 
JOIN RENT 
ON MACHINES.MACH_ID = RENT.MACH_ID 
GROUP BY WARD.WARD_NAME 
ORDER BY TOTAL_MACHINES DESC;

21.' retrieves the total rent earned from each machine, grouped by the panchayat, village, and ward:'

SELECT gp.PANCHAYAT_ID, v.VILLAGE_NAME, w.WARD_NAME, SUM(m.PRICE) AS TOTAL_RENT
FROM GRAM_PANCHAYAT gp
JOIN VILLAGES v ON gp.PANCHAYAT_ID = v.PANCHAYAT_ID
JOIN WARD w ON v.WARD_NO = w.WARD_NO
JOIN MACHINES m ON w.WARD_NO = m.WARD_NO
JOIN RENT r ON m.MACH_ID = r.MACH_ID
GROUP BY gp.PANCHAYAT_ID, v.VILLAGE_NAME, w.WARD_NAME;

22.' retrieves the number of distinct AADH_NO values for farmers who rented a machine that was used in a village named VENKATESHNAGAR for a duration of at least two days'

SELECT COUNT(DISTINCT r.AADH_NO)
FROM RENT r
JOIN MACHINES m ON r.MACH_ID = m.MACH_ID
JOIN MEMBERS mb ON m.MEM_ID = mb.MEM_ID
JOIN WARD w ON mb.WARD_NO = w.WARD_NO
JOIN VILLAGES v ON w.WARD_NO = v.WARD_NO
JOIN FARMER f ON r.AADH_NO = f.AADH_NO
WHERE v.VILLAGE_NAME = 'VENKATESHNAGAR' AND r.TIME1 >= INTERVAL '1' DAY;


23.'Retrieve the village name, ward number, and the number of distinct farmers who rented a machine that was used in that village for at least two days, but did not rent a machine that was used in any other village for the same duration.'

SELECT V.VILLAGE_NAME, V.WARD_NO, COUNT(DISTINCT R.AADH_NO) AS NUM_DISTINCT_FARMERS
FROM VILLAGES V
INNER JOIN WARD W ON V.WARD_NO = W.WARD_NO
INNER JOIN MACHINES M ON W.WARD_NO = M.WARD_NO
INNER JOIN RENT R ON M.MACH_ID = R.MACH_ID
WHERE V.VILLAGE_NAME IN 
    (SELECT V2.VILLAGE_NAME 
     FROM VILLAGES V2 
     INNER JOIN WARD W2 ON V2.WARD_NO = W2.WARD_NO 
     INNER JOIN MACHINES M2 ON W2.WARD_NO = M2.WARD_NO 
     INNER JOIN RENT R2 ON M2.MACH_ID = R2.MACH_ID 
     WHERE R2.TIME1 >= INTERVAL '2' DAY AND V2.VILLAGE_NAME = V.VILLAGE_NAME 
     GROUP BY V2.VILLAGE_NAME 
     HAVING COUNT(DISTINCT M2.MACH_ID) = 1)
GROUP BY V.VILLAGE_NAME, V.WARD_NO;

24.'List all the aadhar numbers of the farmers who have rented a machine along with the machine id and those who have not'

SELECT R.MACH_ID,R.AADH_NO
FROM RENT R
UNION
SELECT M.MACH_ID,F.AADH_NO
FROM MACHINES M
JOIN RENT R ON R.MACH_ID=M.MACH_ID
RIGHT JOIN FARMER F ON F.AADH_NO=R.AADH_NO
WHERE NOT F.AADH_NO=ANY
(SELECT AADH_NO
FROM RENT)

25.'Find the total number of villages in each gram panchayat and display the result in descending order.'

SELECT GRAM_PANCHAYAT.PANCHAYAT_ID, TOT_VILLAGES, COUNT(*) AS NUM_VILLAGES
FROM GRAM_PANCHAYAT
INNER JOIN VILLAGES ON GRAM_PANCHAYAT.PANCHAYAT_ID = VILLAGES.PANCHAYAT_ID
GROUP BY GRAM_PANCHAYAT.PANCHAYAT_ID, TOT_VILLAGES
ORDER BY NUM_VILLAGES DESC;


26.'Procedure to insert a new record into the GRAM_PANCHAYAT table:'

CREATE OR REPLACE PROCEDURE ADD_PANCHAYAT(TOT_WARDS IN NUMBER, TALUKA_NAME IN VARCHAR2, PANCHAYAT_ID IN VARCHAR2, TOT_VILLAGES IN NUMBER) 
AS
BEGIN
  INSERT INTO GRAM_PANCHAYAT VALUES (TOT_WARDS, TALUKA_NAME, PANCHAYAT_ID, TOT_VILLAGES);
  COMMIT;
END;

execute ADD_PANCHAYAT('15','CHITTAPUR','1254','4');

27.'Procedure to update the TALUKA_NAME of a record in the GRAM_PANCHAYAT table:'

CREATE OR REPLACE PROCEDURE UPDATE_TALUKA_NAME(PANCHAYAT_ID IN VARCHAR2, TALUKA_NAME IN VARCHAR2) 
AS
BEGIN
  UPDATE GRAM_PANCHAYAT SET TALUKA_NAME = TALUKA_NAME WHERE PANCHAYAT_ID = PANCHAYAT_ID;
  COMMIT;
END;

28.'Procedure to display the panchayat id of a record with a particular taluka name in the GRAM_PANCHAYAT table'

create or replace procedure p2(name1 in varchar2)
    as
    id number(5);
    begin
    select PANCHAYAT_ID into id  from GRAM_PANCHAYAT where TALUKA_NAME=name1;
    dbms_output.put_line('Name of the taluka with panchayat id='||name1||' is= '||id);
    exception
when too_many_rows then
dbms_output.put_line('more than one row returned');
end;
    /

execute p2('CHITTAPUR');

29.'CURSOR TO RETRIEVE THE FIVE HIGHEST NUMBER OF WARDS OF THE VILLAGES RELATION'

declare
     s VILLAGES.NO_WARDS%type;
     cursor sal_cur is select NO_WARDS from VILLAGES order by NO_WARDS desc;
     begin
     open sal_cur;
     for i in 1..5 loop
     fetch sal_cur into s;
     dbms_output.put_line(s);
     end loop;
    close sal_cur;
    end;
    /
    
30.'Function to display the aadhar number of a farmer given the name.'

create or replace function dis(name in string)
     return number
     as
     adno number;
     begin
     select AADH_NO into adno from FARMER where NAME1=name;
     return adno;
     end;
     /

select dis('RAMESH') from dual;

